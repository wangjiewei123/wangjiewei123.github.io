<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="/plugin/bganimation/bg.css">

  

  <link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css" rel="stylesheet" type="text/css">
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <div class="outer">
        <div class="widget-wrap mobile-header">
  <h3 class="widget-title"></h3>
  <div class="widget">
    <img class="avatar" src="https://avatars0.githubusercontent.com/u/20333903?v=3&amp;s=460">
    <h2 class="author">John Doe</h2>
    <h3 class="description"></h3>
    <div class="count-box">
      <a href="/archives"><div><strong>5</strong><br>文章</div></a>
      <a href="/categories"><div><strong>5</strong><br>分类</div></a>
      <a href="/tags"><div><strong>5</strong><br>标签</div></a>
    </div>
    <ul class="blog-link">
     
          <a href="/" title="Home">
            <li>主页</li>
          </a>
        
          <a href="/archives" title="Archives">
            <li>归档</li>
          </a>
        
          <a href="/categories" title="Categories">
            <li>分类</li>
          </a>
        
          <a href="/tags" title="Tags">
            <li>标签</li>
          </a>
        
    </ul>
  </div>
</div>

        <section id="main">
  
    <article id="post-2022.11.10" class="wow slideInRight article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/11/10/2022.11.10/" class="article-date">
  <time class="post-time" datetime="2022-11-10T10:38:45.000Z" itemprop="datePublished">
    <span class="post-month">11月</span><br/>
    <span class="post-day">10</span>
  </time>
</a>
   
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/11/10/2022.11.10/">2022.11.10问题总结</a>
    </h1>
  

        <div>
          
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%96%B0%E7%9F%A5%E8%AF%86/">新知识</a>,<a class="article-category-link" href="/categories/%E6%96%B0%E7%9F%A5%E8%AF%86/Hexo/">Hexo</a>
  </div>

          
              

          
        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="一、认真看教程真的很重要"><a href="#一、认真看教程真的很重要" class="headerlink" title="一、认真看教程真的很重要"></a>一、认真看教程真的很重要</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">当我尝试hexo deploy命令时git报错</span><br><span class="line">error：RPC failed;curl 56 OpenSSL SSL_read: Connectionwas reset,errno 10054</span><br><span class="line">百度结果是：SSL证书问题或者git中版本问题</span><br><span class="line">从网上查到的解决办法：</span><br><span class="line">    删除掉.deploy_git重新clean、g、d</span><br><span class="line">但是尝试多次后并没有效果，后来通过删掉远程仓库，重新按照教程搞了一边并且后来又删除掉</span><br><span class="line">本地的ssh key并重新生成，添加到github中最终解决了，原因可能是我在搭建过程中漏掉了</span><br><span class="line">某个不起眼的环节导致部署失败，因为后来没有再出现过这个错误，所以并没有深究原因，所以</span><br><span class="line">仔细看教程真的很重要！！！！！</span><br><span class="line"></span><br><span class="line">顺便再记录一下几个以后会常用到的快捷命令</span><br><span class="line">    hexo clean 清除hexo缓存  头三个都可以通过缩写首字母开头来简化命令如：hexo c</span><br><span class="line">    hexo generate 生成文章</span><br><span class="line">    hexo deploy 部署</span><br><span class="line">    hexo new post name 新建文章名</span><br><span class="line">    hexo new page name 新建页面名</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="二、推荐使用Typora软件编辑博客！"><a href="#二、推荐使用Typora软件编辑博客！" class="headerlink" title="二、推荐使用Typora软件编辑博客！"></a>二、推荐使用Typora软件编辑博客！</h3><p>hexo与Typora的完美结合..</p>
<p>Typora是我觉得非常好的Markdown文本编辑器可以拿来做笔记本身支持识别JAVA代码，但是需要收费，Typora对于插入图片的支持做得非常好，在文件-&gt;偏好设置进入设置。</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy9HWTlaSlB4NmJNQWhrZlJCN3k3UUNtUjJpYnRFc3l6dlduYlBWejRCdUFVd2lhWFJvY0FqWjhlZFVvMGp2NHRzWjdOWHptZUQ3ZTRUUDJPa0FFWXN3dXhRLzY0MA?x-oss-process=image/format,png" alt="alt"></p>
<h3 id="三、此外从网上找的几种插入图片办法"><a href="#三、此外从网上找的几种插入图片办法" class="headerlink" title="三、此外从网上找的几种插入图片办法"></a>三、此外从网上找的几种插入图片办法</h3><p>在 <a target="_blank" rel="noopener" href="https://blog.csdn.net/dta0502/article/details/84385460?spm=1001.2101.3001.6650.1&utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-1-84385460-blog-91389277.pc_relevant_landingrelevant&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-1-84385460-blog-91389277.pc_relevant_landingrelevant&utm_relevant_index=2">此网站上有详细教程</a> 上有详细教程！ 此外CSDN博客也支持MD文件上传</p>
<h3 id="src-链接"><a href="#src-链接" class="headerlink" title="src 链接"></a>src 链接</h3><p>如果我要插入的图片，是一个外部的 src 链接地址，比如该图片存放在某网站上，那就使用 Markdown 默认的插入图片的方式，方法和插入链接很像，只是前面多了一个感叹号，如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![alt](https://ws3.sinaimg.cn/large/005BYqpgly1g29eohl7qhj31c00u0dkz.jpg)</span><br></pre></td></tr></table></figure>

<h3 id="本地绝对路径"><a href="#本地绝对路径" class="headerlink" title="本地绝对路径"></a>本地绝对路径</h3><p>当 Hexo 博客中只用到少量图片时，可以将图片统一放在 <em>source&#x2F;images</em> 文件夹中，通过 Markdown 语法访问它们。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![alt](/images/test.jpg)</span><br></pre></td></tr></table></figure>

<h3 id="本地相对路径"><a href="#本地相对路径" class="headerlink" title="本地相对路径"></a>本地相对路径</h3><p>图片除了可以放在统一的 images 文件夹中，还可以放在文章自己的目录中，文章的目录可以通过配置 <em>_config.yml</em>：</p>
<figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">post_asset_folder:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/11/10/2022.11.10/" data-id="clab24y26000080tsfvap34x7" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%B8%A9%E5%9D%91/" rel="tag">踩坑</a></li></ul>

    </footer>
  </div>
  
</article>




  
    <article id="post-2022.11.9" class="wow slideInRight article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/11/09/2022.11.9/" class="article-date">
  <time class="post-time" datetime="2022-11-09T10:38:45.000Z" itemprop="datePublished">
    <span class="post-month">11月</span><br/>
    <span class="post-day">09</span>
  </time>
</a>
   
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/11/09/2022.11.9/">2022.11.9现场管理开发之JPA踩坑记录</a>
    </h1>
  

        <div>
          
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%96%B0%E7%9F%A5%E8%AF%86/">新知识</a>
  </div>

          
              

          
        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="现场管理开发之JPA踩坑记录"><a href="#现场管理开发之JPA踩坑记录" class="headerlink" title="现场管理开发之JPA踩坑记录"></a>现场管理开发之JPA踩坑记录</h3><p>使用save()方法更新数据踩到的坑<br>1、不能更新数据</p>
<p>使用save()方法更新数据时注意：<br>若传入的实体对象id属性有值，则会匹配id进行更新操作；若id属性为空，则会自动新增一条数据到数据库。</p>
<p>但在我实际操作时，有时候save()方法传入的实体对象的id属性有值，却也是新插入了一条数据，这里的原因是save()方法不仅根据id是否为空来判定是否更新，还根据version版本号来判断是否是更新。</p>
<p>在执行插入语句时，注意把版本号写入就不会有这种问题了。<br>2、多次更新数据，报StaleObjectStateException异常</p>
<p>详细如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">org.springframework.orm.ObjectOptimisticLockingFailureException: Object of class [GDAppointmentHisInfo] with identifier: optimistic locking failed;</span><br><span class="line">nested exception is org.hibernate.StaleObjectStateException: Row was updated or deleted by another <span class="title function_">transaction</span> <span class="params">(or unsaved-value mapping was incorrect)</span></span><br></pre></td></tr></table></figure>

<p>翻译：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ObjectOptimisticLockingFailureException:带有标识符的类[GDAppointmentHisInfo]的对象:乐观锁定失败;</span><br><span class="line">嵌套异常org.hibernate。StaleObjectStateException:行被另一个事务更新或删除(或者未保存值映射不正确)</span><br></pre></td></tr></table></figure>

<p>原因：<br>网上给出的解释是StaleObjectStateException因为乐观锁以版本号来加锁，假设第一次更新时获取的数据库对象的版本号为1，执行更新操作之后，版本号变为2，而第二次更新时还是在第一次获取的数据库对象上更新（版本号还是1），因为其版本号已经改变，就抛出这个异常。</p>
<p>解决办法：<br>在第二次更新前，重新取数据库的对象，也就是每次执行更新、删除操作，要在最新的数据库对象上进行更新。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/11/09/2022.11.9/" data-id="clab234930000bstsekv28oq0" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JPA/" rel="tag">JPA</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%B8%A9%E5%9D%91/" rel="tag">踩坑</a></li></ul>

    </footer>
  </div>
  
</article>




  
    <article id="post-2022.11.10 - 副本" class="wow slideInRight article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/11/09/2022.11.10%20-%20%E5%89%AF%E6%9C%AC/" class="article-date">
  <time class="post-time" datetime="2022-11-09T05:38:45.000Z" itemprop="datePublished">
    <span class="post-month">11月</span><br/>
    <span class="post-day">09</span>
  </time>
</a>
   
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/11/09/2022.11.10%20-%20%E5%89%AF%E6%9C%AC/">git踩坑</a>
    </h1>
  

        <div>
          
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%96%B0%E7%9F%A5%E8%AF%86/">新知识</a>,<a class="article-category-link" href="/categories/%E6%96%B0%E7%9F%A5%E8%AF%86/Git/">Git</a>
  </div>

          
              

          
        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>一、warning: LF will be replaced by CRLF in node&#x2F;node_project.The file will have its original line endings in your working directory</p>
<p>1、情景再现：</p>
<p>git add添加文件到暂存区时警告</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">warning: LF will be replaced by CRLF in node/node-project.</span><br><span class="line">The file will have its original line endings in your working directory</span><br></pre></td></tr></table></figure>

<p>2、原因：</p>
<p>这是因为在windows和unix下的换行符不一样，git bush是unix风格设计的，虽然git默认会自动转换，但是有时会出问题</p>
<p>3、解决办法：</p>
<p>禁止自动转换</p>
<p>git config –global core.autocrlf false</p>
<pre><code>1
</code></pre>
<p>二、 ! [rejected] main -&gt; main (fetch first) error: failed to push some refs to ‘<a target="_blank" rel="noopener" href="https://github.com/xxxxxx%E2%80%99">https://github.com/xxxxxx’</a></p>
<p>1、情景再现：</p>
<p>git push origin main 提交代码到远程仓库时报错</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> ! [rejected]        main -&gt; main (fetch first)</span><br><span class="line">error: failed to push some refs to &#x27;https://github.com/xxxxxx&#x27;</span><br><span class="line">hint: Updates were rejected because the remote contains work that you do</span><br><span class="line">hint: not have locally. This is usually caused by another repository pushing</span><br><span class="line">hint: to the same ref. You may want to first integrate the remote changes</span><br><span class="line">hint: (e.g., &#x27;git pull ...&#x27;) before pushing again.</span><br><span class="line">hint: See the &#x27;Note about fast-forwards&#x27; in &#x27;git push --help&#x27; for details.</span><br></pre></td></tr></table></figure>



<p>2、原因：</p>
<p>远程仓库中的代码比本地仓库中的新（存在本地仓库没有的文件）</p>
<p>3、解决办法：</p>
<p>将远程仓库中的代码合并到本地即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git pull --rebase origin main</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/11/09/2022.11.10%20-%20%E5%89%AF%E6%9C%AC/" data-id="clab72j1d0000y8ts43ivax21" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%B8%A9%E5%9D%91/" rel="tag">踩坑</a></li></ul>

    </footer>
  </div>
  
</article>




  
    <article id="post-2022.11.8Node" class="wow slideInRight article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/11/08/2022.11.8Node/" class="article-date">
  <time class="post-time" datetime="2022-11-08T10:38:45.000Z" itemprop="datePublished">
    <span class="post-month">11月</span><br/>
    <span class="post-day">08</span>
  </time>
</a>
   
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/11/08/2022.11.8Node/">2022.11.8Jpa使用过程中遇到的坑2.0</a>
    </h1>
  

        <div>
          
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%80%BB%E7%BB%93/">总结</a>
  </div>

          
              

          
        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="2022-11-8Jpa使用过程中遇到的坑2-0"><a href="#2022-11-8Jpa使用过程中遇到的坑2-0" class="headerlink" title="2022.11.8Jpa使用过程中遇到的坑2.0"></a>2022.11.8Jpa使用过程中遇到的坑2.0</h3><p>1、一定要注意如果我们在实体类中没有配置数据表的默认值，那么在存入和取出的时候应该设置。否则在取出的时候就会出现问题。<br>2、如何通过一方获取到多方实体<br>3、jsp中 jsp文件夹与上面servlet映射名最好不要一致，这样会出问题<br>4、注意！！！！一个实体类的表ID名字请设置为ID，保证不出错。</p>
<p><strong>问题描述</strong><br>    分类和博客 多对多 双向 我这里配置中间表来实现实体类的关联<br>    我现在想要通过策略实体获取所有博客，在打印blog时，准确的说是在调用blog的getCategories时 出现stackoverflow的问题。</p>
<p><strong>问题分析：</strong><br>    因为是双向多对多的关联查询，每一个blog实例会输出Set categories的值，而每一个Category实例则会输出Set blogs的值，因此一直递归下去知道栈溢出报错。</p>
<p><strong>解决方法：</strong>其实一般情况下没有打印的需求</p>
<p>遍历的时候不调用或者先将blogs设置为null</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">category.getBlogs().forEach(x-&gt;&#123;</span><br><span class="line">  		x.setCategories(<span class="literal">null</span>);</span><br><span class="line">  		System.out.pringln(x);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/11/08/2022.11.8Node/" data-id="clab22l70000128tsc0v2c61f" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JPA/" rel="tag">JPA</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95/" rel="tag">踩坑记录</a></li></ul>

    </footer>
  </div>
  
</article>




  
    <article id="post-2022.11.7Node" class="wow slideInRight article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/11/07/2022.11.7Node/" class="article-date">
  <time class="post-time" datetime="2022-11-07T10:38:45.000Z" itemprop="datePublished">
    <span class="post-month">11月</span><br/>
    <span class="post-day">07</span>
  </time>
</a>
   
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/11/07/2022.11.7Node/">2022.11.7EasyExcel</a>
    </h1>
  

        <div>
          
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%96%B0%E7%9F%A5%E8%AF%86/">新知识</a>,<a class="article-category-link" href="/categories/%E6%96%B0%E7%9F%A5%E8%AF%86/EasyExcel/">EasyExcel</a>
  </div>

          
              

          
        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="2022-11-7EasyExcel"><a href="#2022-11-7EasyExcel" class="headerlink" title="2022.11.7EasyExcel"></a>2022.11.7EasyExcel</h3><h3 id="读Excel"><a href="#读Excel" class="headerlink" title="读Excel"></a>读Excel</h3><p>DEMO代码地址：<a target="_blank" rel="noopener" href="https://github.com/alibaba/easyexcel/blob/master/easyexcel-test/src/test/java/com/alibaba/easyexcel/test/demo/read/ReadTest.java">https://github.com/alibaba/easyexcel/blob/master/easyexcel-test/src/test/java/com/alibaba/easyexcel/test/demo/read/ReadTest.java</a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 最简单的读</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;1. 创建excel对应的实体对象 参照&#123;<span class="doctag">@link</span> DemoData&#125;</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;2. 由于默认一行行的读取excel，所以需要创建excel一行一行的回调监听器，参照&#123;<span class="doctag">@link</span> DemoDataListener&#125;</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;3. 直接读即可</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">simpleRead</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> TestFileUtil.getPath() + <span class="string">&quot;demo&quot;</span> + File.separator + <span class="string">&quot;demo.xlsx&quot;</span>;</span><br><span class="line">    <span class="comment">// 这里 需要指定读用哪个class去读，然后读取第一个sheet 文件流会自动关闭</span></span><br><span class="line">    EasyExcel.read(fileName, DemoData.class, <span class="keyword">new</span> <span class="title class_">DemoDataListener</span>()).sheet().doRead();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="写Excel"><a href="#写Excel" class="headerlink" title="写Excel"></a>写Excel</h3><p>DEMO代码地址：<a target="_blank" rel="noopener" href="https://github.com/alibaba/easyexcel/blob/master/easyexcel-test/src/test/java/com/alibaba/easyexcel/test/demo/write/WriteTest.java">https://github.com/alibaba/easyexcel/blob/master/easyexcel-test/src/test/java/com/alibaba/easyexcel/test/demo/write/WriteTest.java</a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 最简单的写</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;1. 创建excel对应的实体对象 参照&#123;<span class="doctag">@link</span> com.alibaba.easyexcel.test.demo.write.DemoData&#125;</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;2. 直接写即可</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">simpleWrite</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> TestFileUtil.getPath() + <span class="string">&quot;write&quot;</span> + System.currentTimeMillis() + <span class="string">&quot;.xlsx&quot;</span>;</span><br><span class="line">    <span class="comment">// 这里 需要指定写用哪个class去读，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span></span><br><span class="line">    <span class="comment">// 如果这里想使用03 则 传入excelType参数即可</span></span><br><span class="line">    EasyExcel.write(fileName, DemoData.class).sheet(<span class="string">&quot;模板&quot;</span>).doWrite(data());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="web上传、下载"><a href="#web上传、下载" class="headerlink" title="web上传、下载"></a>web上传、下载</h3><p>DEMO代码地址：<a target="_blank" rel="noopener" href="https://github.com/alibaba/easyexcel/blob/master/easyexcel-test/src/test/java/com/alibaba/easyexcel/test/demo/web/WebTest.java">https://github.com/alibaba/easyexcel/blob/master/easyexcel-test/src/test/java/com/alibaba/easyexcel/test/demo/web/WebTest.java</a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 文件下载（失败了会返回一个有部分数据的Excel）</span></span><br><span class="line"><span class="comment">  * &lt;p&gt;</span></span><br><span class="line"><span class="comment">  * 1. 创建excel对应的实体对象 参照&#123;<span class="doctag">@link</span> DownloadData&#125;</span></span><br><span class="line"><span class="comment">  * &lt;p&gt;</span></span><br><span class="line"><span class="comment">  * 2. 设置返回的 参数</span></span><br><span class="line"><span class="comment">  * &lt;p&gt;</span></span><br><span class="line"><span class="comment">  * 3. 直接写，这里注意，finish的时候会自动关闭OutputStream,当然你外面再关闭流问题不大</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="meta">@GetMapping(&quot;download&quot;)</span></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">download</span><span class="params">(HttpServletResponse response)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">     <span class="comment">// 这里注意 使用swagger 会导致各种问题，请直接用浏览器或者用postman</span></span><br><span class="line">     response.setContentType(<span class="string">&quot;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot;</span>);</span><br><span class="line">     response.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">     <span class="comment">// 这里URLEncoder.encode可以防止中文乱码 当然和easyexcel没有关系</span></span><br><span class="line">     <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> URLEncoder.encode(<span class="string">&quot;测试&quot;</span>, <span class="string">&quot;UTF-8&quot;</span>).replaceAll(<span class="string">&quot;\\+&quot;</span>, <span class="string">&quot;%20&quot;</span>);</span><br><span class="line">     response.setHeader(<span class="string">&quot;Content-disposition&quot;</span>, <span class="string">&quot;attachment;filename*=utf-8&#x27;&#x27;&quot;</span> + fileName + <span class="string">&quot;.xlsx&quot;</span>);</span><br><span class="line">     EasyExcel.write(response.getOutputStream(), DownloadData.class).sheet(<span class="string">&quot;模板&quot;</span>).doWrite(data());</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 文件上传</span></span><br><span class="line"><span class="comment">  * &lt;p&gt;1. 创建excel对应的实体对象 参照&#123;<span class="doctag">@link</span> UploadData&#125;</span></span><br><span class="line"><span class="comment">  * &lt;p&gt;2. 由于默认一行行的读取excel，所以需要创建excel一行一行的回调监听器，参照&#123;<span class="doctag">@link</span> UploadDataListener&#125;</span></span><br><span class="line"><span class="comment">  * &lt;p&gt;3. 直接读即可</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="meta">@PostMapping(&quot;upload&quot;)</span></span><br><span class="line"> <span class="meta">@ResponseBody</span></span><br><span class="line"> <span class="keyword">public</span> String <span class="title function_">upload</span><span class="params">(MultipartFile file)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">     EasyExcel.read(file.getInputStream(), UploadData.class, <span class="keyword">new</span> <span class="title class_">UploadDataListener</span>(uploadDAO)).sheet().doRead();</span><br><span class="line">     <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/11/07/2022.11.7Node/" data-id="clab22l6w000028tsbxuw0xaq" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%A0%87%E7%AD%BE1/" rel="tag">标签1</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%A0%87%E7%AD%BE2/" rel="tag">标签2</a></li></ul>

    </footer>
  </div>
  
</article>




  

</section>
        
          <aside id="sidebar">
  
    <div class="widget-wrap">
  <h3 class="widget-title"></h3>
  <div class="widget">
    <h1 class="blog-title">Hexo</h1>
    <h2 class="blog-subtitle"></h2>
    <ul class="blog-link">
     
          <a href="/" title="Home">
            <li>主页</li>
          </a>
        
          <a href="/archives" title="Archives">
            <li>归档</li>
          </a>
        
          <a href="/categories" title="Categories">
            <li>分类</li>
          </a>
        
          <a href="/tags" title="Tags">
            <li>标签</li>
          </a>
        
    </ul>
  </div>
</div>

  
    <div class="widget-wrap">
  <h3 class="widget-title"></h3>
  <div class="widget">
    <img class="avatar" src="https://avatars0.githubusercontent.com/u/20333903?v=3&amp;s=460">
    <h2 class="author">John Doe</h2>
    <h3 class="description"></h3>
    <div class="count-box">
      <a href="/archives"><div><strong>5</strong><br>文章</div></a>
      <a href="/categories"><div><strong>5</strong><br>分类</div></a>
      <a href="/tags"><div><strong>5</strong><br>标签</div></a>
    </div>



    <div class="social-link">
      
        <a class="hvr-bounce-in" href="https://github.com/wangjiewei123/wangjiewei123.github.io.git" target="_blank" title="Github">
          Github
        </a>
      
    </div>

    <div class="friend-link">
      <h2>友情链接</h2>
      
        <a class="hvr-bounce-in" href="" target="_blank" title="PC端右键调出移动端长按">
          PC端右键调出移动端长按
        </a>
      
    </div>
  </div>
</div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy;2021 - 2022 John Doe<br>
      由<a href="http://hexo.io/" target="_blank">Hexo</a>强力驱动 | 
      主题-<a target="_blank" rel="noopener" href="https://github.com/ShanaMaid/hexo-theme-shana">Shana</a>
      
    </div>
    
  </div>
</footer>
    </div>
    

<script src="//apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="//apps.bdimg.com/libs/wow/0.1.6/wow.min.js"></script>
<script>
new WOW().init();
</script>   


  
<link rel="stylesheet" href="/plugin/fancybox/jquery.fancybox.css">

  
<script src="/plugin/fancybox/jquery.fancybox.pack.js"></script>




  
<link rel="stylesheet" href="/plugin/galmenu/GalMenu.css">

  
<script src="/plugin/galmenu/GalMenu.js"></script>

  <div class="GalMenu GalDropDown">
      <div class="circle" id="gal">
        <div class="ring">
          
            <a target="_blank" rel="noopener" href="https://cuihuihen.github.io/" title="" class="menuItem">崔慧辰</a>
          
            <a target="_blank" rel="noopener" href="https://kcq123.github.io/" title="" class="menuItem">寇超强</a>
          
            <a target="_blank" rel="noopener" href="https://yaofuquan1.github.io/" title="" class="menuItem">姚福泉</a>
          
            <a target="_blank" rel="noopener" href="https://muhuiling.github.io/" title="" class="menuItem">牟慧玲</a>
          
            <a target="_blank" rel="noopener" href="https://zhangchunjia.github.io/" title="" class="menuItem">张纯</a>
          
            <a href="/xxxxxxx" title="" class="menuItem">xxxx</a>
          
        </div>
        
          <audio id="audio" src="#"></audio>
        
      </div> 
</div>
<div id="overlay" style="opacity: 1; cursor: pointer;"></div>
  <script type="text/javascript">var items = document.querySelectorAll('.menuItem');
    for (var i = 0,
    l = items.length; i < l; i++) {
      items[i].style.left = (50 - 35 * Math.cos( - 0.5 * Math.PI - 2 * (1 / l) * i * Math.PI)).toFixed(4) + "%";
      items[i].style.top = (50 + 35 * Math.sin( - 0.5 * Math.PI - 2 * (1 / l) * i * Math.PI)).toFixed(4) + "%"
    }</script>
<script type="text/javascript">
  $(document).ready(function() {
    $('body').GalMenu({
      'menu': 'GalDropDown'
    })
  });
</script>

  <section class="hidden-xs"> 
  <ul class="cb-slideshow"> 
    <li><span>苟利</span></li> 
    <li><span>国家</span></li> 
    <li><span>生死以</span></li> 
    <li><span>岂能</span></li> 
    <li><span>祸福</span></li> 
    <li><span>趋避之</span></li> 
  </ul>
</section>

<script src="/js/script.js"></script>




  </div>
</body>
</html>